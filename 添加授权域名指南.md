# 🔧 如何添加授权域名到 Firebase

## 问题原因
Google 登录失败,提示"当前域名未授权",这是因为 Firebase 的安全机制,只允许在授权的域名上使用登录功能。

---

## 解决步骤

### 第一步:打开 Firebase 控制台

1. 访问: https://console.firebase.google.com/
2. 选择项目: **fir-f0c9e**

### 第二步:进入 Authentication 设置

1. 在左侧菜单中找到 **Build** (构建)
2. 点击 **Authentication** (身份验证)
3. 点击顶部的 **Settings** (设置) 标签页

### 第三步:添加授权域名

在 **Authorized domains** (授权域名) 部分:

1. 点击 **Add domain** 按钮
2. 输入域名: `localhost`
3. 点击 **Add** 确认

4. 再次点击 **Add domain**
5. 输入域名: `127.0.0.1`
6. 点击 **Add** 确认

### 第四步:验证

添加完成后,你应该看到类似这样的列表:

```
✓ fir-f0c9e.firebaseapp.com
✓ localhost        (新添加)
✓ 127.0.0.1        (新添加)
```

---

## 📸 截图位置参考

```
Firebase 控制台界面结构:

┌─────────────────────────────────────────┐
│  fir-f0c9e  ▼                           │
├─────────────────────────────────────────┤
│                                         │
│  🔲 Build                               │
│    ├─ Authentication  ← 点这里          │
│    ├─ Firestore                        │
│    └─ Storage                          │
│                                         │
│  Authentication 页面:                   │
│  ┌───────────────────────────────────┐ │
│  │  Users  |  Sign-in method  |  Settings  │ │
│  │                                ↑ 点这里 │ │
│  │  Authorized domains:             │ │
│  │  ┌───────────────────────────┐  │ │
│  │  │ fir-f0c9e.firebaseapp.com │  │ │
│  │  │ localhost                 │  │ │
│  │  │ 127.0.0.1                 │  │ │
│  │  └───────────────────────────┘  │ │
│  │          [Add domain]            │ │
│  └───────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

---

## ⚠️ 常见错误

### 错误 1: 找不到 "Authorized domains"
**解决**: 确保你在 Authentication → Settings 标签页,不是 Sign-in method

### 错误 2: 添加后仍然报错
**解决**:
1. 检查浏览器地址栏的域名
2. 确保添加的域名与地址栏一致(包括端口号)
3. 刷新页面重试

### 错误 3: 端口号问题
如果浏览器地址是 `http://127.0.0.1:5500`,添加以下域名:
```
127.0.0.1
127.0.0.1:5500
localhost
localhost:5500
```

---

## 🔍 如何确认当前使用的域名?

查看浏览器地址栏:

```
https://127.0.0.1:5500/index.html
         ↑^^^^^^^^^^^↑
         这是域名和端口
```

常见本地开发域名:
- `http://localhost:5500` → 添加 `localhost` 和 `localhost:5500`
- `http://127.0.0.1:5500` → 添加 `127.0.0.1` 和 `127.0.0.1:5500`
- `http://localhost:8000` → 添加 `localhost` 和 `localhost:8000`
- `http://127.0.0.1:8000` → 添加 `127.0.0.1` 和 `127.0.0.1:8000`

---

## ✅ 添加完成后的测试

1. 刷新浏览器页面
2. 打开浏览器控制台 (F12)
3. 点击 "Google 登录" 按钮
4. 应该会弹出 Google 授权窗口
5. 控制台会显示: "开始 Google 登录流程..."

---

## 🚀 推荐配置

为了开发方便,建议添加以下所有域名:

```
localhost
127.0.0.1
localhost:5500
127.0.0.1:5500
localhost:8000
127.0.0.1:8000
localhost:3000
127.0.0.1:3000
```

这样无论使用哪个端口或地址,都可以正常工作。

---

## 📝 部署到生产环境时

当你部署到真实域名时(例如 `https://yourdomain.com`):

1. 在 Firebase 控制台添加生产域名:
   ```
   yourdomain.com
   www.yourdomain.com
   ```

2. 重新测试 Google 登录功能

---

## 💡 小提示

- Firebase 免费计划最多支持 **10 个授权域名**
- 定期清理不再使用的域名
- 生产环境和开发环境使用不同的 Firebase 项目(推荐)

---

完成后,刷新页面重试 Google 登录功能!
